<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <title>Group 23 - EDA</title>

  <!-- CSS only -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
  <link href="/docs/5.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">

  <!-- Favicons -->

  <!-- Custom styles for this template -->
  <link href="css/styles.css" rel="stylesheet">
</head>

<body>

<!-- Navbar -->
<div class="container" style="max-width: 800px">
    <nav class="navbar mx-auto bg-light px-4 fixed-top">
        <a class="navbar-brand" href="index.html">Big Data and Cloud Computing - Final Project</a>
        <ul class="nav nav-pills justify-content-center">
          
          <li class="nav-item"><a class="nav-link" href="index.html#projectIntroduction" style="color: black">Project Introduction</a></li>
          <li class="nav-item"><a class="nav-link" href="index.html#aboutTeam" style="color: black">About the Team</a></li>
          <li class="nav-item"><a class="nav-link" href="EDA.html" style="color: black">EDA</a></li>
        </ul>
      </nav>


 


    <br>
    <h2>Data Exploration</h2>
    <hr>
    <br>

    <p>
        The original dataset used for analysis is <mark>The Pushshift Reddit Dataset</mark><a href="https://arxiv.org/pdf/2001.08435.pdf" target="_blank">(link)</a>. It contains all the submissions and comments posted on Reddit between June 2005 and April 2019.  
    </p>
    <br>



    <p class="lead">
        Read and check size & schema of the Dataset
    </p>
    <p>
        The format of the dataset is parquet and made up of two components: "submissions" and "comments". The submissions file contains 643,255,528 rows and 68 columns, and the comment file contains 4,473,556,762 rows and 21 columns. <mark>???(check) Both of the columns contain nested columns??? Elaborate more on the schema structure</mark> 
    </p>


    <!-- IMAGE: schema -->
    <div class="row py-5">

        <div class="col-md-6">
          <div class="card p-0" style="border: none">
              <img src="img/EDA/submission_schema.png" class="card-img-top" alt="...">
            <div class="card-body">
                <p>Schema snippet of "Submission" file</p>

            </div>
          </div>
        </div>
      
      
      
        <div class="col-md-6">
          <div class="card p-0" style="border: none">
              <img src="img/EDA/comment_schema.png" class="card-img-top" alt="...">
            <div class="card-body">
                <p>Schema snippet of "Comment" file</p>
            </div>
          </div>
        </div>

        <!-- IMAGE: schema END -->

    <p><mark>Add figure number</mark></p>
    
    </div>
    


    <p class="lead">
        Subreddit selection (Filtering the Dataset)
    </p>
    <p>
        The first approach of filtering the dataset was to use the subreddit column in the dataset. <mark>Add "How did we get the idea of selecting these subreddits?</mark> 
    </p>

    <div class="table-responsive">
        <table class="table">
            <caption>TABLE 1: Selected subreddits</caption>
            <thead>
              <tr>
                <th scope="col">Category</th>
                <th scope="col">Subreddit Name</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>RU Conflict</td>
                <td>ukraine, ukraina, UkraineConflict, RussiaUkraineWar2022, UkrainianConflict, UkraineWarReports, UkraineInvasionVideos, UkraineWarVideoReport</td>
                
              </tr>
              <tr>
              
                <td>Military Related</td>
                <td>war, CombatFootage, CredibleDefense, geopolitics</td>
                
              </tr>
              
            </tbody>
          </table>
    
    </div>
    

    <br>
    <br>


    <!-- Code snippet for filtering -->
    <div class="border rounded bg-secondary text-white">
        <pre>
        <code>
    # Using subreddit to filter the data

    ru_subreddit_list = ['ukraine', 'ukraina', 'UkraineConflict',\
        'RussiaUkraineWar2022', 'UkrainianConflict',\
        'UkraineWarReports', 'UkraineInvasionVideos',\
        'UkraineWarVideoReport']

    war_subreddit_list = ['war', "CombatFootage", "CredibleDefense", "geopolitics"]
    war_search_keywords = r'(^|\s)(ukraine|ukrainian|russia|russian|putin|zelenskyy)(\s|$)'
    

    # Filtering submission file

    df_sub = df_submission.filter((F.col('subreddit').isin(ru_subreddit_list)) |
    ((F.col('subreddit').isin(war_subreddit_list)) & (F.lower(F.col('selftext')) \
        .rlike(war_search_keywords))))
    df_sub = df_sub.withColumn("created_utc", F.from_unixtime("created_utc"))
    df_sub = df_sub.withColumn("created_date", F.to_date("created_utc"))
    df_sub = df_sub.filter(F.col("created_date") >= "2022-01-01")
    df_sub.count()

    
    # Filtering comment file

    df_com_all = df_comment.filter((F.col('subreddit').isin(ru_subreddit_list)) |
          ((F.col('subreddit').isin(war_subreddit_list)) & (F.lower(F.col('body')) \
        .rlike(war_search_keywords))))
    df_com_all = df_com_all.withColumn("created_utc", F.from_unixtime("created_utc"))
    df_com_all = df_com_all.withColumn("created_date", F.to_date("created_utc"))
    df_com_all = df_com_all.filter(F.col("created_date") >= "2022-01-01")
    df_com_all.count()
        </code>
    </pre>
    </div>
        <!-- Code snippet for filtering END -->



    <br>
    <br>



    <p class="lead">
        Feature selection
    </p>
    <p>

    </p>


    </br>
<br>
<br>

    
    
    <br>
    <br>

    <b>Summary Statistics</b><br> 
    
    <h4>Datasets Table Containing</h4> 
    1. Size of the datasets<br>
    2. Row counts of each data (Comments, Submissions, Commodity Price/Volatility)<br>
    3. Number of Missing Body comments/posts, daily transations<br>
    4. Start/End Date<br>

    <h4>Subreddits Table Containing </h4>
    1. Number of Submission<br>
    2. Number of Comments<br>
    3. Active Users on each Subrredit<br>
    4. Number of Texts Containing Foreign Language (Dummy Varaible)<br>

    <h4>Commodity Return/Volatility Table Containing</h4>>
    1. Price Summary For Each Commodity<br>

    <br><br>


    <table class="table table-bordered table-hover table-condensed">
        <thead><tr><th title="Field #1">Stats</th>
        <th title="Field #2">Reddit Submissions</th>
        <th title="Field #3">Reddit Comments</th>
        <th title="Field #4">Commodity Prices</th>
        </tr></thead>
        <tbody><tr>
        <td>Size</td>
        <td>0.05G</td>
        <td>1.4G</td>
        <td>166KB</td>
        </tr>
        <tr>
        <td>Columns</td>
        <td>69</td>
        <td>22</td>
        <td>15</td>
        </tr>
        <tr>
        <td>Rows</td>
        <td>384,972</td>
        <td>9,993,790</td>
        <td>1,455</td>
        </tr>
        <tr>
        <td>Missing Values</td>
        <td>54,375[delete]; 259,328 no-text</td>
        <td>367,528[delete]; 25 no-text</td>
        <td>2927</td>
        </tr>
        <tr>
        <td>Startdate</td>
        <td>2022-01-01</td>
        <td>2022-01-01</td>
        <td>2018-01-02</td>
        </tr>
        <tr>
        <td>Enddate</td>
        <td>2022-08-31</td>
        <td>2022-08-31</td>
        <td>2022-08-31</td>
        </tr>
        </tbody>
    </table>
<br><br>



<table class="table table-bordered table-hover table-condensed">
<thead><tr><th title="Field #1">Subreddit</th>
<th title="Field #2">CombatFootage</th>
<th title="Field #3">CredibleDefense</th>
<th title="Field #4">RussiaUkraineWar2022</th>
<th title="Field #5">UkraineConflict</th>
<th title="Field #6">UkraineInvasionVideos</th>
<th title="Field #7">UkraineWarReports</th>
<th title="Field #8">UkraineWarVideoReport</th>
<th title="Field #9">UkrainianConflict</th>
<th title="Field #10">geopolitics</th>
<th title="Field #11">ukraina</th>
<th title="Field #12">ukraine</th>
<th title="Field #13">war</th>
</tr></thead>
<tbody><tr>
<td># of Submissions</td>
<td>107</td>
<td>169</td>
<td>25513</td>
<td>13394</td>
<td>14360</td>
<td>7746</td>
<td>45260</td>
<td>86925</td>
<td>60</td>
<td>17975</td>
<td>172818</td>
<td>645</td>
</tr>
<tr>
<td># of Comments</td>
<td>270539</td>
<td>64817</td>
<td>481116</td>
<td>72528</td>
<td>116823</td>
<td>78552</td>
<td>1724675</td>
<td>1987549</td>
<td>23085</td>
<td>158422</td>
<td>4990804</td>
<td>24880</td>
</tr>
<tr>
<td>Active Users</td>
<td>50383</td>
<td>4828</td>
<td>48934</td>
<td>10933</td>
<td>16474</td>
<td>14175</td>
<td>157469</td>
<td>129635</td>
<td>5526</td>
<td>25841</td>
<td>262567</td>
<td>7485</td>
</tr>
<tr>
<td>Contains Foreign Langauge</td>
<td>36.45%</td>
<td>18.34%</td>
<td>27.33%</td>
<td>29.79%</td>
<td>30.88%</td>
<td>30.03%</td>
<td>29.08%</td>
<td>25.03%</td>
<td>13.33%</td>
<td>50.05%</td>
<td>27.01%</td>
<td>21.86%</td>
</tr>
</tbody></table>
<br><br>







    <table class="table table-bordered table-hover table-condensed">
        <thead><tr><th title="Field #1">Stats</th>
        <th title="Field #2">Barley</th>
        <th title="Field #3">Cocoa</th>
        <th title="Field #4">Coffee</th>
        <th title="Field #5">Corn Futures</th>
        <th title="Field #6">Crude Oil</th>
        <th title="Field #7">Heating Oil</th>
        <th title="Field #8">Natural Gas</th>
        <th title="Field #9">Newcastle Coal</th>
        <th title="Field #10">Oats</th>
        <th title="Field #11">RBOB Gasoline</th>
        <th title="Field #12">Rough Rice</th>
        <th title="Field #13">Soybean Meal Futures</th>
        <th title="Field #14">Soybean Oil Futures</th>
        <th title="Field #15">Sugar #11</th>
        <th title="Field #16">Wheat</th>
        </tr></thead>
        <tbody><tr>
        <td>Count</td>
        <td align="right">1149</td>
        <td align="right">1178</td>
        <td align="right">1177</td>
        <td align="right">1193</td>
        <td align="right">1268</td>
        <td align="right">1263</td>
        <td align="right">1268</td>
        <td align="right">1191</td>
        <td align="right">1176</td>
        <td align="right">1262</td>
        <td align="right">1177</td>
        <td align="right">1184</td>
        <td align="right">1200</td>
        <td align="right">1181</td>
        <td align="right">1191</td>
        </tr>
        <tr>
        <td>Mean</td>
        <td align="right">1897.88</td>
        <td align="right">2434.53</td>
        <td align="right">138.38</td>
        <td align="right">459.15</td>
        <td align="right">62.73</td>
        <td align="right">2.06</td>
        <td align="right">3.35</td>
        <td align="right">130.71</td>
        <td align="right">371.37</td>
        <td align="right">1.92</td>
        <td align="right">12.99</td>
        <td align="right">348.65</td>
        <td align="right">41.72</td>
        <td align="right">14.53</td>
        <td align="right">615.65</td>
        </tr>
        <tr>
        <td>Std</td>
        <td align="right">491.47</td>
        <td align="right">195.72</td>
        <td align="right">48.13</td>
        <td align="right">133.72</td>
        <td align="right">20.48</td>
        <td align="right">0.76</td>
        <td align="right">1.68</td>
        <td align="right">97.25</td>
        <td align="right">151.57</td>
        <td align="right">0.69</td>
        <td align="right">1.94</td>
        <td align="right">54.63</td>
        <td align="right">17.05</td>
        <td align="right">3.04</td>
        <td align="right">172.68</td>
        </tr>
        <tr>
        <td>Min</td>
        <td align="right">1305.50</td>
        <td align="right">1895.00</td>
        <td align="right">86.65</td>
        <td align="right">302.75</td>
        <td align="right">-37.63</td>
        <td align="right">0.61</td>
        <td align="right">1.48</td>
        <td align="right">48.50</td>
        <td align="right">220.75</td>
        <td align="right">0.41</td>
        <td align="right">9.78</td>
        <td align="right">280.00</td>
        <td align="right">24.99</td>
        <td align="right">9.21</td>
        <td align="right">416.50</td>
        </tr>
        <tr>
        <td>25%</td>
        <td align="right">1518.50</td>
        <td align="right">2314.00</td>
        <td align="right">104.10</td>
        <td align="right">362.75</td>
        <td align="right">52.07</td>
        <td align="right">1.70</td>
        <td align="right">2.40</td>
        <td align="right">67.85</td>
        <td align="right">273.19</td>
        <td align="right">1.48</td>
        <td align="right">11.70</td>
        <td align="right">303.77</td>
        <td align="right">28.59</td>
        <td align="right">12.15</td>
        <td align="right">504.25</td>
        </tr>
        <tr>
        <td>50%</td>
        <td align="right">1817.50</td>
        <td align="right">2436.00</td>
        <td align="right">118.20</td>
        <td align="right">387.25</td>
        <td align="right">61.35</td>
        <td align="right">1.98</td>
        <td align="right">2.78</td>
        <td align="right">97.15</td>
        <td align="right">300.50</td>
        <td align="right">1.90</td>
        <td align="right">12.56</td>
        <td align="right">329.40</td>
        <td align="right">31.70</td>
        <td align="right">13.36</td>
        <td align="right">541.00</td>
        </tr>
        <tr>
        <td>75%</td>
        <td align="right">2100.00</td>
        <td align="right">2552.00</td>
        <td align="right">158.70</td>
        <td align="right">557.25</td>
        <td align="right">70.78</td>
        <td align="right">2.19</td>
        <td align="right">3.73</td>
        <td align="right">141.58</td>
        <td align="right">403.81</td>
        <td align="right">2.16</td>
        <td align="right">13.74</td>
        <td align="right">391.65</td>
        <td align="right">57.95</td>
        <td align="right">17.66</td>
        <td align="right">693.00</td>
        </tr>
        <tr>
        <td>Max</td>
        <td align="right">3261.00</td>
        <td align="right">3054.00</td>
        <td align="right">258.35</td>
        <td align="right">818.25</td>
        <td align="right">123.70</td>
        <td align="right">5.14</td>
        <td align="right">9.68</td>
        <td align="right">440.00</td>
        <td align="right">807.00</td>
        <td align="right">4.31</td>
        <td align="right">22.07</td>
        <td align="right">521.90</td>
        <td align="right">90.60</td>
        <td align="right">20.42</td>
        <td align="right">1425.25</td>
        </tr>
        </tbody></table>
        
        Note:
        
        1.Due to difference in trading rules, commodity futures can have different number of trading days.
        
        2.Crude Oil had negative price during Covid when cost of carry exceeded intrinsic value.

        <br><br>





</div> <!-- container -->


<footer class="blog-footer">
  <p>
    <a href="#">Back to top</a>
  </p>
</footer>



</body>
</html>